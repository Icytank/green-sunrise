---
import { Image } from "astro:assets";
import GSStamp from "./GSStamp.astro";
import { formatExperience, processCertifications } from "./TeamMember.logic";
import type { TeamMemberProps } from "./TeamMember.logic";
import { t } from "../utils/i18n-helpers";

interface Props extends TeamMemberProps {
    avatar: ImageMetadata;
}

const { name, role, certifications, yearsExperience, verified, lang, avatar } = Astro.props;

const formattedExperience = formatExperience(yearsExperience);
const filteredCertifications = processCertifications(certifications);
---

<div class="team-member-card">
    <div class="image-container">
        <Image src={avatar} alt={name} width={400} height={400} class="avatar" />
        {verified && (
            <div class="stamp-overlay" title={t('team.verifiedProfile', lang)} aria-label={t('team.verifiedProfile', lang)}>
                <GSStamp size={70} />
            </div>
        )}
    </div>
    <div class="info">
        <h3 class="name">{name}</h3>
        <p class="role">{role}</p>
        <div class="experience">
            <span class="exp-label">{t('team.experience', lang)}:</span>
            <span class="exp-value">{formattedExperience} {t('team.yearsSuffix', lang)}</span>
        </div>
        {filteredCertifications.length > 0 && (
            <div class="certifications">
                <h4 class="cert-title">{t('team.certifications', lang)}</h4>
                <ul class="cert-list">
                    {filteredCertifications.map((cert) => (
                        <li>{cert}</li>
                    ))}
                </ul>
            </div>
        )}
    </div>
</div>

<style>
    .team-member-card {
        background: var(--gs-executive-white);
        border: 1px solid var(--gs-border);
        padding: var(--gs-space-3);
        display: flex;
        flex-direction: column;
        gap: var(--gs-space-3);
        height: 100%;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        position: relative;
    }

    .team-member-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 24px rgba(6, 78, 59, 0.1);
        border-color: var(--gs-institutional-green);
    }

    .image-container {
        position: relative;
        width: 100%;
        aspect-ratio: 1;
        overflow: hidden;
        background: var(--gs-slate-gray);
        border: 1px solid var(--gs-border);
    }

    .avatar {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .stamp-overlay {
        position: absolute;
        top: -10px;
        right: -10px;
        z-index: 2;
        transform: rotate(-5deg);
    }

    .info {
        display: flex;
        flex-direction: column;
        gap: var(--gs-space-1);
    }

    .name {
        font-size: var(--gs-text-h5);
        font-weight: 700;
        color: var(--gs-institutional-green);
        margin: 0;
        line-height: 1.2;
    }

    .role {
        font-size: var(--gs-text-xs);
        font-weight: 700;
        color: var(--gs-slate-gray);
        text-transform: uppercase;
        letter-spacing: 0.1em;
        margin: 0;
    }

    .experience {
        margin-top: var(--gs-space-1);
        font-size: var(--gs-text-sm);
        display: flex;
        gap: var(--gs-space-1);
    }

    .exp-label {
        font-weight: 700;
        color: var(--gs-text-primary);
    }

    .exp-value {
        color: var(--gs-slate-gray);
        font-family: var(--gs-font-mono);
    }

    .certifications {
        margin-top: var(--gs-space-2);
        padding-top: var(--gs-space-2);
        border-top: 1px solid var(--gs-border);
    }

    .cert-title {
        font-size: var(--gs-text-xs);
        font-weight: 800;
        text-transform: uppercase;
        color: var(--gs-institutional-green);
        margin-bottom: var(--gs-space-1);
        font-family: var(--gs-font-primary);
    }

    .cert-list {
        list-style: none;
        padding: 0;
        margin: 0;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .cert-list li {
        font-size: var(--gs-text-xs);
        line-height: 1.3;
        color: var(--gs-text-primary);
        position: relative;
        padding-left: 14px;
        font-weight: 500;
    }

    .cert-list li::before {
        content: "â€¢";
        position: absolute;
        left: 0;
        color: var(--gs-success-emerald);
        font-weight: bold;
    }
</style>
