---
// Server Side Logic for Smart Geo-Redirect
// This runs on Cloudflare Edge

const runtime = Astro.locals.runtime;
const country = runtime?.cf?.country;

// Logic: 
// 1. If country is "BG", redirect to /bg
// 2. For any other country (or if unknown/local dev), redirect to /en
//    (English is the safer global default than Bulgarian)

let targetLang = "en";

if (country === "BG") {
    targetLang = "bg";
} else if (!country) {
    // Fallback for local dev or when header is missing
    // You can change this to "bg" if you prefer that as default
    targetLang = "bg"; 
}

return Astro.redirect(`/${targetLang}`);
---
